 f')).toThrow(
                         ~~~~~~~~~~~~~~

      src/lang/interpreter.ts:94:40
        94 export function executeProgram(vm: VM, code: string): void {
                                                  ~~~~~~~~~~~~
        An argument for 'code' was not provided.
    src/test/lang/path-brackets.comprehensive.test.ts:115:5 - error TS2554: Expected 2 arguments, but got 1.

    115     executeProgram(': f (10 20) var x x[-1] ; f');
            ~~~~~~~~~~~~~~

      src/lang/interpreter.ts:94:40
        94 export function executeProgram(vm: VM, code: string): void {
                                                  ~~~~~~~~~~~~
        An argument for 'code' was not provided.
    src/test/lang/path-brackets.comprehensive.test.ts:122:18 - error TS2554: Expected 2 arguments, but got 1.

    122     expect(() => executeProgram(code)).toThrow(/store expects DATA_REF address/i);
                         ~~~~~~~~~~~~~~

      src/lang/interpreter.ts:94:40
        94 export function executeProgram(vm: VM, code: string): void {
                                                  ~~~~~~~~~~~~
        An argument for 'code' was not provided.
    src/test/lang/path-brackets.comprehensive.test.ts:135:5 - error TS2554: Expected 2 arguments, but got 1.

    135     executeProgram(code);
            ~~~~~~~~~~~~~~

      src/lang/interpreter.ts:94:40
        94 export function executeProgram(vm: VM, code: string): void {
                                                  ~~~~~~~~~~~~
        An argument for 'code' was not provided.

m FAIL  src/test/lang/parser.comprehensive.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/parser-variables.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/parser-symbol.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/parser-redefinition.test.ts
  ● Test suite failed to run

    src/test/lang/parser-redefinition.test.ts:2:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    2 import { resetVM } from '../utils/vm-test-utils';
               ~~~~~~~
    src/test/lang/parser-redefinition.test.ts:24:37 - error TS2554: Expected 2 arguments, but got 1.

    24     const out = captureOutput(() => executeProgram(': x 123 . ; x : x x x ; x'));
                                           ~~~~~~~~~~~~~~

      src/lang/interpreter.ts:94:40
        94 export function executeProgram(vm: VM, code: string): void {
                                                  ~~~~~~~~~~~~
        An argument for 'code' was not provided.

m FAIL  src/test/lang/parser-list.test.ts
  ● Test suite failed to run

    src/lang/interpreter.ts:116:20 - error TS2304: Cannot find name 'vm'.

    116   const returnIP = vm.IP;
                           ~~
    src/lang/interpreter.ts:120:9 - error TS2304: Cannot find name 'vm'.

    120   rpush(vm, toTaggedValue(returnIP, Tag.CODE));
                ~~
    src/lang/interpreter.ts:122:9 - error TS2304: Cannot find name 'vm'.

    122   rpush(vm, vm.bp - RSTACK_BASE_CELLS);
                ~~
    src/lang/interpreter.ts:122:13 - error TS2304: Cannot find name 'vm'.

    122   rpush(vm, vm.bp - RSTACK_BASE_CELLS);
                    ~~
    src/lang/interpreter.ts:123:3 - error TS2304: Cannot find name 'vm'.

    123   vm.bp = vm.rsp;
          ~~
    src/lang/interpreter.ts:123:11 - error TS2304: Cannot find name 'vm'.

    123   vm.bp = vm.rsp;
                  ~~
    src/lang/interpreter.ts:125:3 - error TS2304: Cannot find name 'vm'.

    125   vm.IP = codePtr;
          ~~
    src/lang/interpreter.ts:126:3 - error TS2304: Cannot find name 'vm'.

    126   vm.running = true;
          ~~
    src/lang/interpreter.ts:127:11 - error TS2304: Cannot find name 'vm'.

    127   execute(vm, vm.IP);
                  ~~
    src/lang/interpreter.ts:127:15 - error TS2304: Cannot find name 'vm'.

    127   execute(vm, vm.IP);
                      ~~
    src/lang/interpreter.ts:129:7 - error TS2304: Cannot find name 'vm'.

    129   if (vm.IP !== returnIP) {
              ~~
    src/lang/interpreter.ts:130:9 - error TS2304: Cannot find name 'vm'.

    130     if (vm.debug) {
                ~~
    src/lang/interpreter.ts:131:91 - error TS2304: Cannot find name 'vm'.

    131       console.warn(`Warning: IP mismatch after function call. Expected ${returnIP}, got ${vm.IP}`);
                                                                                                  ~~
    src/lang/interpreter.ts:133:5 - error TS2304: Cannot find name 'vm'.

    133     vm.IP = returnIP;
            ~~

 FAIL  src/test/lang/local-vars-integration.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/local-vars-error-handling.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/list-compilation.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
        m    ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/interpreter.test.ts
  ● Test suite failed to run

    src/lang/interpreter.ts:116:20 - error TS2304: Cannot find name 'vm'.

    116   const returnIP = vm.IP;
                           ~~
    src/lang/interpreter.ts:120:9 - error TS2304: Cannot find name 'vm'.

    120   rpush(vm, toTaggedValue(returnIP, Tag.CODE));
                ~~
    src/lang/interpreter.ts:122:9 - error TS2304: Cannot find name 'vm'.

    122   rpush(vm, vm.bp - RSTACK_BASE_CELLS);
                ~~
    src/lang/interpreter.ts:122:13 - error TS2304: Cannot find name 'vm'.

    122   rpush(vm, vm.bp - RSTACK_BASE_CELLS);
                    ~~
    src/lang/interpreter.ts:123:3 - error TS2304: Cannot find name 'vm'.

    123   vm.bp = vm.rsp;
          ~~
    src/lang/interpreter.ts:123:11 - error TS2304: Cannot find name 'vm'.

    123   vm.bp = vm.rsp;
                  ~~
    src/lang/interpreter.ts:125:3 - error TS2304: Cannot find name 'vm'.

    125   vm.IP = codePtr;
          ~~
    src/lang/interpreter.ts:126:3 - error TS2304: Cannot find name 'vm'.

    126   vm.running = true;
          ~~
    src/lang/interpreter.ts:127:11 - error TS2304: Cannot find name 'vm'.

    127   execute(vm, vm.IP);
                  ~~
    src/lang/interpreter.ts:127:15 - error TS2304: Cannot find name 'vm'.

    127   execute(vm, vm.IP);
                      ~~
    src/lang/interpreter.ts:129:7 - error TS2304: Cannot find name 'vm'.

    129   if (vm.IP !== returnIP) {
              ~~
    src/lang/interpreter.ts:130:9 - error TS2304: Cannot find name 'vm'.

    130     if (vm.debug) {
                ~~
    src/lang/interpreter.ts:131:91 - error TS2304: Cannot find name 'vm'.

    131       console.warn(`Warning: IP mismatch after function call. Expected ${returnIP}, got ${vm.IP}`);
                                                                                                  ~~
    src/lang/interpreter.ts:133:5 - error TS2304: Cannot find name 'vm'.

    133     vm.IP = returnIP;
            ~~

 FAIL  src/test/lang/interpreter-coverage.test.ts
  ● Test suite failed to run

    src/lang/interpreter.ts:116:20 - error TS2304: Cannot find name 'vm'.

    116   const returnIP = vm.IP;
                           ~~
    src/lang/interpreter.ts:120:9 - error TS2304: Cannot find name 'vm'.

    120   rpush(vm, toTaggedValue(returnIP, Tag.CODE));
                ~~
    src/lang/interpreter.ts:122:9 - error TS2304: Cannot find name 'vm'.

    122   rpush(vm, vm.bp - RSTACK_BASE_CELLS);
                ~~
    src/lang/interpreter.ts:122:13 - error TS2304: Cannot find name 'vm'.

    122   rpush(vm, vm.bp - RSTACK_BASE_CELLS);
                    ~~
    src/lang/interpreter.ts:123:3 - error TS2304: Cannot find name 'vm'.

    123   vm.bp = vm.rsp;
          ~~
    src/lang/interpreter.ts:123:11 - error TS2304: Cannot find name 'vm'.

    123   vm.bp = vm.rsp;
                  ~~
    src/lang/interpreter.ts:125:3 - error TS2304: Cannot find name 'vm'.

    125   vm.IP = codePtr;
          ~~
    src/lang/interpreter.ts:126:3 - error TS2304: Cannot find name 'vm'.

    126   vm.running = true;
          ~~
    src/lang/interpreter.ts:127:11 - error TS2304: Cannot find name 'vm'.

    127   execute(vm, vm.IP);
                  ~~
    src/lang/interpreter.ts:127:15 - error TS2304: Cannot find name 'vm'.

    127   execute(vm, vm.IP);
                      ~~
    src/lang/interpreter.ts:129:7 - error TS2304: Cannot find name 'vm'.

    129   if (vm.IP !== returnIP) {
              ~~
    src/lang/interpreter.ts:130:9 - error TS2304: Cannot find name 'vm'.

    130     if (vm.debug) {
                ~~
    src/lang/interpreter.ts:131:91 - error TS2304: Cannot find name 'vm'.

    131       console.warn(`Warning: IP mismatch after function call. Expected ${returnIP}, got ${vm.IP}`);
                                                                                                  ~~
    src/lang/interpreter.ts:133:5 - error TS2304: Cannot find name 'vm'.

    133     vm.IP = returnIP;
            ~~

 FAIL  src/test/lang/file-processor.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/immediate-words.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/executor.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/end-to-end-local-vars.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/conditionals-immediate.test.ts
  ● Test suite failed to run

    src/test/lang/conditionals-immediate.test.ts:4:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    4 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/lang/conditionals-immediate.test.ts:10:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    10 import { resetVM, verifyTaggedValue } from '../utils/vm-test-utils';
                ~~~~~~~
    src/test/lang/conditionals-immediate.test.ts:13:18 - error TS2345: Argument of type '{ tokenizer: Tokenizer; currentDefinition: null; }' is not assignable to parameter of type 'ParserState'.
      Property 'vm' is missing in type '{ tokenizer: Tokenizer; currentDefinition: null; }' but required in type 'ParserState'.

    13   setParserState({ tokenizer: new Tokenizer(''), currentDefinition: null });
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      src/lang/state.ts:13:3
        13   vm: VM;
             ~~
        'vm' is declared here.
    src/test/lang/conditionals-immediate.test.ts:84:18 - error TS2554: Expected 1 arguments, but got 0.

    84     expect(() => ensureNoOpenConditionals()).toThrow('Unclosed IF');
                        ~~~~~~~~~~~~~~~~~~~~~~~~

      src/lang/meta/conditionals.ts:69:42
        69 export function ensureNoOpenConditionals(vm: VM): void {
                                                    ~~~~~~
        An argument for 'vm' was not provided.
    src/test/lang/conditionals-immediate.test.ts:89:18 - error TS2554: Expected 1 arguments, but got 0.

    89     expect(() => ensureNoOpenConditionals()).toThrow('Unclosed `when`');
                        ~~~~~~~~~~~~~~~~~~~~~~~~

      src/lang/meta/conditionals.ts:69:42
        69 export function ensureNoOpenConditionals(vm: VM): void {
                                                    ~~~~~~
        An argument for 'vm' was not provided.
    src/test/lang/conditionals-immediate.test.ts:93:18 - error TS2554: Expected 1 arguments, but got 0.

    93     expect(() => ensureNoOpenConditionals()).not.toThrow();
                        ~~~~~~~~~~~~~~~~~~~~~~~~

      src/lang/meta/conditionals.ts:69:42
        69 export function ensureNoOpenConditionals(vm: VM): void {
                                                    ~~~~~~
        An argument for 'vm' was not provided.

 FAIL  src/test/lang/compiler.test.ts
  ● Test suite failed to run

    src/test/lang/compiler.test.ts:2:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    2 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
               ~~~~~~~~~~~~~~~~~~~~~
    src/test/lang/compiler.test.ts:2:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    2 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                      ~~

 FAIL  src/test/lang/compiler-functions.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/compiler-coverage.test.ts
  ● Test suite failed to run

    src/test/lang/compiler-coverage.test.ts:6:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    6 import { vm, initializeInterpreter } from '../utils/vm-test-utils';
               ~~
    src/test/lang/compiler-coverage.test.ts:6:14 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    6 import { vm, initializeInterpreter } from '../utils/vm-test-utils';
                   ~~~~~~~~~~~~~~~~~~~~~

 FAIL  src/test/lang/clean-exit-test.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/lang/case-corruption-branch.test.ts
  ● Test suite failed to run

    src/test/lang/case-corruption-branch.test.ts:1:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    1 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/lang/case-corruption-branch.test.ts:2:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    2 import { resetVM } from '../utils/vm-test-utils';
               ~~~~~~~

 FAIL  src/test/lang/case-immediate.test.ts
  ● Test suite failed to run

    src/test/lang/case-immediate.test.ts:4:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    4 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/lang/case-immediate.test.ts:17:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    17 import { resetVM } from '../utils/vm-test-utils';
                ~~~~~~~
    src/test/lang/case-immediate.test.ts:20:18 - error TS2345: Argument of type '{ tokenizer: Tokenizer; currentDefinition: null; }' is not assignable to parameter of type 'ParserState'.
      Property 'vm' is missing in type '{ tokenizer: Tokenizer; currentDefinition: null; }' but required in type 'ParserState'.

    20   setParserState({ tokenizer: new Tokenizer(''), currentDefinition: null });
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

      src/lang/state.ts:13:3
        13   vm: VM;
             ~~
        'vm' is declared here.
    src/test/lang/case-immediate.test.ts:103:18 - error TS2554: Expected 1 arguments, but got 0.

    103     expect(() => ensureNoOpenConditionals()).toThrow('Unclosed case');
                         ~~~~~~~~~~~~~~~~~~~~~~~~

      src/lang/meta/conditionals.ts:69:42
        69 export function ensureNoOpenConditionals(vm: VM): void {
                                                    ~~~~~~
        An argument for 'vm' was not provided.

 FAIL  src/test/lang/case-control-flow.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/integration/symbol-table-integration.test.ts
  ● Test suite failed to run

    src/test/integration/symbol-table-integration.test.ts:17:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    17 import { vm } from '../utils/vm-test-utils';
                ~~
    src/test/integration/symbol-table-integration.test.ts:19:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    19 import { resetVM } from '../utils/vm-test-utils';
                ~~~~~~~

 FAIL  src/test/integration/basic-operations.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/integration/advanced-operations.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/core/vm-ip-operations.test.ts
  ● Test suite failed to run

    src/test/core/vm-ip-operations.test.ts:4:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    4 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
               ~~~~~~~~~~~~~~~~~~~~~
    src/test/core/vm-ip-operations.test.ts:4:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    4 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                      ~~

 FAIL  src/test/core/vm-unified-dispatch.test.ts
  ● Test suite failed to run

    src/test/core/vm-unified-dispatch.test.ts:9:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    9 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/core/vm-unified-dispatch.test.ts:11:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    11 import { resetVM } from '../utils/vm-test-utils';
                ~~~~~~~

 FAIL  src/test/core/vm-push-symbol-ref.test.ts
  ● Test suite failed to run

    src/test/core/vm-push-symbol-ref.test.ts:8:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    8 import { resetVM } from '../utils/vm-test-utils';
               ~~~~~~~
    src/test/core/vm-push-symbol-ref.test.ts:9:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    9 import { vm } from '../utils/vm-test-utils';
               ~~

 FAIL  src/test/core/vm-symbol-resolution.test.ts
  ● Test suite failed to run

    src/test/core/vm-symbol-resolution.test.ts:9:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    9 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/core/vm-symbol-resolution.test.ts:11:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    11 import { resetVM } from '../utils/vm-test-utils';
                ~~~~~~~

 FAIL  src/test/core/vm-stack-operations.test.ts
  ● Test suite failed to run

    src/test/core/vm-stack-operations.test.ts:9:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    9 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
               ~~~~~~~~~~~~~~~~~~~~~
    src/test/core/vm-stack-operations.test.ts:9:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    9 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                      ~~

 FAIL  src/test/core/vm-comprehensive-testing.test.ts
  ● Test suite failed to run

    src/test/core/vm-comprehensive-testing.test.ts:18:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    18 import { resetVM } from '../utils/vm-test-utils';
                ~~~~~~~
    src/test/core/vm-comprehensive-testing.test.ts:19:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    19 import { vm } from '../utils/vm-test-utils';
                ~~

 FAIL  src/test/core/vm-abs-registers.test.ts
  ● Test suite failed to run

    src/test/core/vm-abs-registers.test.ts:3:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    3 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/core/vm-abs-registers.test.ts:4:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    4 import { resetVM } from '../utils/vm-test-utils';
               ~~~~~~~

 FAIL  src/test/core/unified-data-ref.test.ts
  ● Test suite failed to run

    src/test/core/unified-data-ref.test.ts:21:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    21 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                ~~~~~~~~~~~~~~~~~~~~~
    src/test/core/unified-data-ref.test.ts:21:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    21 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                       ~~

 FAIL  src/test/core/tagged-value-roundtrip.test.ts
  ● Test suite failed to run

    src/test/core/tagged-value-roundtrip.test.ts:4:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    4 import { resetVM } from '../utils/vm-test-utils';
               ~~~~~~~
    src/test/core/tagged-value-roundtrip.test.ts:5:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    5 import { vm } from '../utils/vm-test-utils';
               ~~

m FAIL  src/test/core/reference-formatting.test.ts
  ● Test suite failed to run

    src/test/core/reference-formatting.test.ts:20:9 - error TS2554: Expected 2 arguments, but got 3.

    20         `
               ~
    21         : test-local-ref (1 2 3) var x x . ;
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    22         test-local-ref
       ~~~~~~~~~~~~~~~~~~~~~~
    23       `,
       ~~~~~~~
    src/test/core/reference-formatting.test.ts:57:9 - error TS2554: Expected 2 arguments, but got 3.

    57         `
               ~
    58         : test-simple-ref 42 var x x . ;
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    59         test-simple-ref
       ~~~~~~~~~~~~~~~~~~~~~~~
    60       `,
       ~~~~~~~

 FAIL  src/test/core/memory-segdata.test.ts
  ● Test suite failed to run

    src/test/core/memory-segdata.test.ts:2:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    2 import { vm } from '../utils/vm-test-utils';
               ~~
    src/test/core/memory-segdata.test.ts:3:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'resetVM'.

    3 import { resetVM } from '../utils/vm-test-utils';
               ~~~~~~~

 FAIL  src/test/core/list.coverage.test.ts
  ● Test suite failed to run

    src/test/core/list.coverage.test.ts:1:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    1 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
               ~~~~~~~~~~~~~~~~~~~~~
    src/test/core/list.coverage.test.ts:1:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    1 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                      ~~

 FAIL  src/test/core/list-memory.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/core/format-utils.test.ts
  ● Test suite failed to run

    src/test/core/format-utils.test.ts:2:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    2 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
               ~~~~~~~~~~~~~~~~~~~~~
    src/test/core/format-utils.test.ts:2:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    2 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                      ~~

 FAIL  src/test/core/format-utils.coverage.test.ts
  ● Test suite failed to run

    src/test/core/format-utils.coverage.test.ts:1:10 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'initializeInterpreter'.

    1 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
               ~~~~~~~~~~~~~~~~~~~~~
    src/test/core/format-utils.coverage.test.ts:1:33 - error TS2305: Module '"../utils/vm-test-utils"' has no exported member 'vm'.

    1 import { initializeInterpreter, vm } from '../utils/vm-test-utils';
                                      ~~

 FAIL  src/test/cli/cli.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~

 FAIL  src/test/tacit-test-utils.test.ts
  ● Test suite failed to run

    src/lang/parser.ts:177:23 - error TS2304: Cannot find name 'vm'.

    177   const tval = lookup(vm, value);
                              ~~
    src/lang/parser.ts:179:54 - error TS2304: Cannot find name 'vm'.

    179     throw new UndefinedWordError(value, getStackData(vm));
                                                             ~~
    src/lang/parser.ts:186:26 - error TS2304: Cannot find name 'vm'.

    186     executeImmediateWord(vm, value, { taggedValue: tval, isImmediate });
                                 ~~
    src/lang/parser.ts:194:5 - error TS2304: Cannot find name 'vm'.

    194     vm.compiler.compileUserWordCall(tagValue);
            ~~
    src/lang/parser.ts:199:5 - error TS2304: Cannot find name 'vm'.

    199     vm.compiler.compileOpcode(tagValue);
            ~~
    src/lang/parser.ts:204:5 - error TS2304: Cannot find name 'vm'.

    204     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:205:5 - error TS2304: Cannot find name 'vm'.

    205     vm.compiler.compile16(tagValue);
            ~~
    src/lang/parser.ts:206:5 - error TS2304: Cannot find name 'vm'.

    206     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:211:7 - error TS2304: Cannot find name 'vm'.

    211       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:212:7 - error TS2304: Cannot find name 'vm'.

    212       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:213:7 - error TS2304: Cannot find name 'vm'.

    213       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:222:56 - error TS2304: Cannot find name 'vm'.

    222       throw new UndefinedWordError(value, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:225:5 - error TS2304: Cannot find name 'vm'.

    225     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:226:5 - error TS2304: Cannot find name 'vm'.

    226     vm.compiler.compileFloat32(entryValue);
            ~~
    src/lang/parser.ts:231:7 - error TS2304: Cannot find name 'vm'.

    231       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:232:7 - error TS2304: Cannot find name 'vm'.

    232       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:233:7 - error TS2304: Cannot find name 'vm'.

    233       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:236:7 - error TS2304: Cannot find name 'vm'.

    236       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:238:7 - error TS2304: Cannot find name 'vm'.

    238       vm.compiler.compileOpcode(Op.Load);
              ~~
    src/lang/parser.ts:243:52 - error TS2304: Cannot find name 'vm'.

    243   throw new UndefinedWordError(value, getStackData(vm));
                                                           ~~
    src/lang/parser.ts:261:3 - error TS2304: Cannot find name 'vm'.

    261   vm.compiler.compileOpcode(Op.LiteralString);
          ~~
    src/lang/parser.ts:262:25 - error TS2304: Cannot find name 'vm'.

    262   const stringAddress = vm.digest.add(symbolName);
                                ~~
    src/lang/parser.ts:263:3 - error TS2304: Cannot find name 'vm'.

    263   vm.compiler.compile16(stringAddress);
          ~~
    src/lang/parser.ts:265:3 - error TS2304: Cannot find name 'vm'.

    265   vm.compiler.compileOpcode(Op.PushSymbolRef);
          ~~
    src/lang/parser.ts:279:23 - error TS2304: Cannot find name 'vm'.

    279   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:281:56 - error TS2304: Cannot find name 'vm'.

    281     throw new UndefinedWordError(varName, getStackData(vm));
                                                               ~~
    src/lang/parser.ts:289:7 - error TS2304: Cannot find name 'vm'.

    289       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:290:7 - error TS2304: Cannot find name 'vm'.

    290       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:291:7 - error TS2304: Cannot find name 'vm'.

    291       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:298:7 - error TS2304: Cannot find name 'vm'.

    298       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:299:7 - error TS2304: Cannot find name 'vm'.

    299       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:300:7 - error TS2304: Cannot find name 'vm'.

    300       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:308:5 - error TS2304: Cannot find name 'vm'.

    308     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:309:5 - error TS2304: Cannot find name 'vm'.

    309     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:328:20 - error TS2304: Cannot find name 'vm'.

    328       getStackData(vm),
                           ~~
    src/lang/parser.ts:334:76 - error TS2304: Cannot find name 'vm'.

    334     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:345:76 - error TS2304: Cannot find name 'vm'.

    345     throw new SyntaxError('Expected variable name after var', getStackData(vm));
                                                                                   ~~
    src/lang/parser.ts:348:3 - error TS2304: Cannot find name 'vm'.

    348   vm.compiler.emitReserveIfNeeded();
          ~~
    src/lang/parser.ts:350:15 - error TS2304: Cannot find name 'vm'.

    350   defineLocal(vm, varName);
                      ~~
    src/lang/parser.ts:351:22 - error TS2304: Cannot find name 'vm'.

    351   const slotNumber = vm.localCount - 1;
                             ~~
    src/lang/parser.ts:353:3 - error TS2304: Cannot find name 'vm'.

    353   vm.compiler.compileOpcode(Op.InitVar);
          ~~
    src/lang/parser.ts:354:3 - error TS2304: Cannot find name 'vm'.

    354   vm.compiler.compile16(slotNumber);
          ~~
    src/lang/parser.ts:378:75 - error TS2304: Cannot find name 'vm'.

    378     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:389:75 - error TS2304: Cannot find name 'vm'.

    389     throw new SyntaxError('Expected variable name after ->', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:392:23 - error TS2304: Cannot find name 'vm'.

    392   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:403:7 - error TS2304: Cannot find name 'vm'.

    403       vm.compiler.compileOpcode(Op.VarRef);
              ~~
    src/lang/parser.ts:404:7 - error TS2304: Cannot find name 'vm'.

    404       vm.compiler.compile16(slotNumber);
              ~~
    src/lang/parser.ts:405:7 - error TS2304: Cannot find name 'vm'.

    405       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:408:7 - error TS2304: Cannot find name 'vm'.

    408       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:409:7 - error TS2304: Cannot find name 'vm'.

    409       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:410:7 - error TS2304: Cannot find name 'vm'.

    410       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:417:5 - error TS2304: Cannot find name 'vm'.

    417     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:418:5 - error TS2304: Cannot find name 'vm'.

    418     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:419:5 - error TS2304: Cannot find name 'vm'.

    419     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:426:22 - error TS2304: Cannot find name 'vm'.

    426         getStackData(vm),
                             ~~
    src/lang/parser.ts:431:7 - error TS2304: Cannot find name 'vm'.

    431       vm.compiler.compileOpcode(Op.LiteralNumber);
              ~~
    src/lang/parser.ts:432:7 - error TS2304: Cannot find name 'vm'.

    432       vm.compiler.compileFloat32(tval);
              ~~
    src/lang/parser.ts:433:7 - error TS2304: Cannot find name 'vm'.

    433       vm.compiler.compileOpcode(Op.Fetch);
              ~~
    src/lang/parser.ts:435:7 - error TS2304: Cannot find name 'vm'.

    435       vm.compiler.compileOpcode(Op.Select);
              ~~
    src/lang/parser.ts:436:7 - error TS2304: Cannot find name 'vm'.

    436       vm.compiler.compileOpcode(Op.Nip);
              ~~
    src/lang/parser.ts:437:7 - error TS2304: Cannot find name 'vm'.

    437       vm.compiler.compileOpcode(Op.Store);
              ~~
    src/lang/parser.ts:442:5 - error TS2304: Cannot find name 'vm'.

    442     vm.compiler.compileOpcode(Op.LiteralNumber);
            ~~
    src/lang/parser.ts:443:5 - error TS2304: Cannot find name 'vm'.

    443     vm.compiler.compileFloat32(tval);
            ~~
    src/lang/parser.ts:444:5 - error TS2304: Cannot find name 'vm'.

    444     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:450:18 - error TS2304: Cannot find name 'vm'.

    450     getStackData(vm),
                         ~~
    src/lang/parser.ts:471:20 - error TS2304: Cannot find name 'vm'.

    471       getStackData(vm),
                           ~~
    src/lang/parser.ts:477:75 - error TS2304: Cannot find name 'vm'.

    477     throw new SyntaxError('Expected variable name after +>', getStackData(vm));
                                                                                  ~~
    src/lang/parser.ts:482:23 - error TS2304: Cannot find name 'vm'.

    482   const tval = lookup(vm, varName);
                              ~~
    src/lang/parser.ts:496:5 - error TS2304: Cannot find name 'vm'.

    496     vm.compiler.compileOpcode(Op.VarRef);
            ~~
    src/lang/parser.ts:497:5 - error TS2304: Cannot find name 'vm'.

    497     vm.compiler.compile16(slotNumber);
            ~~
    src/lang/parser.ts:498:5 - error TS2304: Cannot find name 'vm'.

    498     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:500:5 - error TS2304: Cannot find name 'vm'.

    500     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:501:5 - error TS2304: Cannot find name 'vm'.

    501     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:504:5 - error TS2304: Cannot find name 'vm'.

    504     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:505:5 - error TS2304: Cannot find name 'vm'.

    505     vm.compiler.compileOpcode(Op.Over);
            ~~
    src/lang/parser.ts:506:5 - error TS2304: Cannot find name 'vm'.

    506     vm.compiler.compileOpcode(Op.Fetch);
            ~~
    src/lang/parser.ts:507:5 - error TS2304: Cannot find name 'vm'.

    507     vm.compiler.compileOpcode(Op.Add);
            ~~
    src/lang/parser.ts:508:5 - error TS2304: Cannot find name 'vm'.

    508     vm.compiler.compileOpcode(Op.Swap);
            ~~
    src/lang/parser.ts:509:5 - error TS2304: Cannot find name 'vm'.

    509     vm.compiler.compileOpcode(Op.Store);
            ~~
    src/lang/parser.ts:518:3 - error TS2304: Cannot find name 'vm'.

    518   vm.compiler.compileOpcode(Op.VarRef);
          ~~
    src/lang/parser.ts:519:3 - error TS2304: Cannot find name 'vm'.

    519   vm.compiler.compile16(slotNumber); // [..., inc, addr]
          ~~
    src/lang/parser.ts:520:3 - error TS2304: Cannot find name 'vm'.

    520   vm.compiler.compileOpcode(Op.Swap); // [..., addr, inc]
          ~~
    src/lang/parser.ts:521:3 - error TS2304: Cannot find name 'vm'.

    521   vm.compiler.compileOpcode(Op.Over); // [..., addr, inc, addr]
          ~~
    src/lang/parser.ts:522:3 - error TS2304: Cannot find name 'vm'.

    522   vm.compiler.compileOpcode(Op.Fetch); // [..., addr, inc, value]
          ~~
    src/lang/parser.ts:523:3 - error TS2304: Cannot find name 'vm'.

    523   vm.compiler.compileOpcode(Op.Add); // [..., addr, sum]
          ~~
    src/lang/parser.ts:524:3 - error TS2304: Cannot find name 'vm'.

    524   vm.compiler.compileOpcode(Op.Swap); // [..., sum, addr]
          ~~
    src/lang/parser.ts:525:3 - error TS2304: Cannot find name 'vm'.

    525   vm.compiler.compileOpcode(Op.Store); // []
          ~~
    src/lang/parser.ts:534:3 - error TS2304: Cannot find name 'vm'.

    534   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:550:20 - error TS2304: Cannot find name 'vm'.

    550       getStackData(vm),
                           ~~
    src/lang/parser.ts:553:3 - error TS2304: Cannot find name 'vm'.

    553   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:580:5 - error TS2304: Cannot find name 'vm'.

    580     vm.compiler.compileOpcode(Op.Select);
            ~~
    src/lang/parser.ts:581:5 - error TS2304: Cannot find name 'vm'.

    581     vm.compiler.compileOpcode(Op.Load);
            ~~
    src/lang/parser.ts:582:5 - error TS2304: Cannot find name 'vm'.

    582     vm.compiler.compileOpcode(Op.Nip);
            ~~
    src/lang/parser.ts:619:3 - error TS2304: Cannot find name 'vm'.

    619   vm.listDepth++;
          ~~
    src/lang/parser.ts:620:3 - error TS2304: Cannot find name 'vm'.

    620   vm.compiler.compileOpcode(Op.OpenList);
          ~~
    src/lang/parser.ts:628:7 - error TS2304: Cannot find name 'vm'.

    628   if (vm.listDepth <= 0) {
              ~~
    src/lang/parser.ts:629:74 - error TS2304: Cannot find name 'vm'.

    629     throw new SyntaxError('Unexpected closing parenthesis', getStackData(vm));
                                                                                 ~~
    src/lang/parser.ts:632:3 - error TS2304: Cannot find name 'vm'.

    632   vm.compiler.compileOpcode(Op.CloseList);
          ~~
    src/lang/parser.ts:633:3 - error TS2304: Cannot find name 'vm'.

    633   vm.listDepth--;
          ~~


Test Suites: 118 failed, 29 passed, 147 total
Tests:       2 failed, 324 passed, 326 total
Snapshots:   0 total
Time:        32.551 s
Ran all test suites matching /\/Users\/johnhardy\/Documents\/projects\/ts-tacitus\/src\/test/i.
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
